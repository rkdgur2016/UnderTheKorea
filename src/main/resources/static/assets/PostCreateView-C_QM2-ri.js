import{_ as z,H as R,I as A,r as b,a as m,b as D,w as f,e as n,o as d,f as e,n as k,D as N,E as _,G as q,x as u,z as c,J as F,g as H,p as G,A as g,t as M,q as V,h as C,u as T,j as $}from"./index-CBojKAhj.js";const J={class:"min-h-screen bg-gradient-to-br from-slate-50 to-gray-100"},E={class:"bg-white border-b border-slate-200"},O={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},Z={class:"flex items-center justify-between"},K={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Q={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},X=["value"],Y={class:"mt-6"},ee={class:"flex justify-between mt-1"},te={class:"text-xs text-slate-500"},le={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},se={class:"flex justify-between mt-1"},oe={class:"text-xs text-slate-500"},ae={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ie={class:"mb-4"},ne={class:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:border-slate-400 transition-colors"},de=["disabled"],ue={key:1,class:"relative"},ve=["src"],me=["disabled"],ce=["disabled"],pe={key:0,class:"mt-4"},xe={class:"aspect-video bg-slate-100 rounded-lg overflow-hidden"},be=["src"],fe={class:"mt-6"},ge=["disabled"],he={key:0,class:"mt-4"},we={class:"aspect-video bg-slate-100 rounded-lg overflow-hidden"},ye=["src"],Ue={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},ke={class:"flex items-center justify-between"},_e={class:"flex space-x-4"},Me=["disabled"],Ve={key:0,class:"flex items-center"},Ce={key:1},Le={__name:"PostCreateView",setup(Ie){const L=T(),p=R(),I=A(),l=b({title:"",category:"",content:{ops:[{insert:`
`}]},imageUrl:"",videoUrl:"",shortsUrl:""}),j=m(()=>p.getLoggedInUser);D(()=>{p.initializeAuth(),j.value||(alert("게시물을 작성하려면 로그인이 필요합니다. 로그인 페이지로 이동합니다."),I.openLogin())});const v=b(!1),o=b(""),r=b(null),h=m(()=>{const s=contentLength;return l.value.title.trim().length>0&&l.value.category.trim().length>0&&s>=10}),y=m(()=>{if(!l.value.videoUrl)return"";const s=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/,t=l.value.videoUrl.match(s);return t?`https://www.youtube.com/embed/${t[1]}`:""}),U=m(()=>{if(!l.value.shortsUrl)return"";const s=/(?:youtube\.com\/shorts\/|youtu\.be\/)([a-zA-Z0-9_-]+)/,t=l.value.shortsUrl.match(s);return t?`https://www.youtube.com/embed/${t[1]}`:""}),B=s=>{const t=s.target.files[0];if(!t)return;if(t.size>5*1024*1024){alert("파일 크기는 5MB 이하여야 합니다."),r.value&&(r.value.value=""),o.value="";return}const x=new FileReader;x.onload=w=>{o.value=w.target.result},x.readAsDataURL(t),l.value.imageUrl=""},S=()=>{o.value="",l.value.imageUrl="",r.value&&(r.value.value="")},i=m(()=>o.value!==""||l.value.imageUrl.trim()!==""||l.value.videoUrl.trim()!==""||l.value.shortsUrl.trim()!==""),P=async()=>{if(h.value){v.value=!0;try{const s={authorId:p.getUserId,title:l.value.title.trim(),category:l.value.category,content:JSON.stringify(l.value.content),imageUrl:l.value.imageUrl||null,videoUrl:l.value.videoUrl||null,shortUrl:l.value.shortsUrl||null},t=await $.post("/post/savePosts",s);console.log("게시물 데이터:",s),console.log("서버 응답:",t.data),localStorage.removeItem("postDraft"),alert("게시물이 성공적으로 등록되었습니다!"),L.push("/")}catch(s){console.error("게시물 등록 실패:",s),alert("게시물 등록에 실패했습니다. 다시 시도해주세요.")}finally{v.value=!1}}};return f(()=>l.value.imageUrl,(s,t)=>{s&&s.trim()!==""&&(l.value.videoUrl="",l.value.shortsUrl="",o.value="",r.value&&(r.value.value=""))}),f(()=>l.value.videoUrl,(s,t)=>{s&&s.trim()!==""&&(l.value.imageUrl="",l.value.shortsUrl="",o.value="",r.value&&(r.value.value=""))}),f(()=>l.value.shortsUrl,(s,t)=>{s&&s.trim()!==""&&(l.value.imageUrl="",l.value.videoUrl="",o.value="",r.value&&(r.value.value=""))}),f(o,(s,t)=>{s!==""&&(l.value.imageUrl="",l.value.videoUrl="",l.value.shortsUrl="")}),(s,t)=>{const x=_("router-link"),w=_("quill-editor");return d(),n("div",J,[e("div",E,[e("div",O,[e("div",Z,[t[8]||(t[8]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-800"},"새 게시물 작성"),e("p",{class:"text-sm text-slate-500 mt-1"}," 대한민국의 미래를 함께 논의해보세요 ")],-1)),k(x,{to:"/",class:"text-slate-500 hover:text-slate-700 transition-colors"},{default:N(()=>t[7]||(t[7]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),_:1,__:[7]})])])]),e("div",K,[e("form",{onSubmit:q(P,["prevent"]),class:"space-y-8"},[e("div",Q,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),u(" 기본 정보 ")],-1)),e("div",W,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[u(" 카테고리 "),e("span",{class:"text-red-500"},"*")],-1)),c(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>l.value.category=a),required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},t[9]||(t[9]=[H('<option value="" data-v-ee748db1>카테고리를 선택하세요</option><option value="철학" data-v-ee748db1>철학</option><option value="정치" data-v-ee748db1>정치</option><option value="경제" data-v-ee748db1>경제</option><option value="사회" data-v-ee748db1>사회</option>',5)]),512),[[F,l.value.category]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"작성자",-1)),e("input",{value:G(p).getUserId,readonly:"",class:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg text-slate-600"},null,8,X),t[12]||(t[12]=e("p",{class:"text-xs text-slate-500 mt-1"}," 사용자가 수동으로 변경할 수 없습니다. ",-1))])]),e("div",Y,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[u(" 제목 "),e("span",{class:"text-red-500"},"*")],-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.title=a),type:"text",required:"",maxlength:"100",placeholder:"게시물 제목을 입력하세요",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},null,512),[[g,l.value.title]]),e("div",ee,[t[13]||(t[13]=e("p",{class:"text-xs text-slate-500"}," 과한 어그로성 제목은 삼가해주세요 ",-1)),e("span",te,M(l.value.title.length)+"/100",1)])])]),e("div",le,[t[18]||(t[18]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h7"})]),u(" 내용 작성 ")],-1)),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[u(" 본문 "),e("span",{class:"text-red-500"},"*")],-1)),k(w,{theme:"snow",modelValue:l.value.content,"onUpdate:modelValue":t[2]||(t[2]=a=>l.value.content=a),contentType:"delta",class:"h-72"},null,8,["modelValue"]),e("div",se,[t[16]||(t[16]=e("p",{class:"text-xs text-slate-500"}," 자유롭게 게시물을 작성해주세요. ",-1)),e("span",oe,M(s.contentLength)+"자",1)])])]),e("div",ae,[t[27]||(t[27]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.587a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})]),u(" 미디어 첨부 (선택사항) ")],-1)),e("div",re,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"이미지",-1)),e("div",ie,[e("div",ne,[e("input",{ref_key:"fileInput",ref:r,type:"file",accept:"image/*",onChange:B,class:"hidden",disabled:i.value&&!o.value},null,40,de),o.value?(d(),n("div",ue,[e("img",{src:o.value,alt:"미리보기",class:"max-h-32 mx-auto rounded"},null,8,ve),e("button",{onClick:S,type:"button",class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 transform translate-x-2 -translate-y-2"},t[20]||(t[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])):(d(),n("div",{key:0,onClick:t[3]||(t[3]=a=>(!i.value||!o.value)&&s.$refs.fileInput.click()),class:V({"cursor-pointer":!i.value||!o.value,"cursor-not-allowed opacity-50":i.value&&!o.value})},t[19]||(t[19]=[e("svg",{class:"mx-auto h-12 w-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),e("p",{class:"mt-2 text-sm text-slate-600"}," 클릭하여 이미지 업로드 ",-1),e("p",{class:"text-xs text-slate-500"}," PNG, JPG, GIF (최대 5MB) ",-1)]),2))])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-xs text-slate-500 mb-1"},"또는 이미지 URL 입력",-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.imageUrl=a),type:"url",placeholder:"https://example.com/image.jpg",class:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors",disabled:i.value&&l.value.imageUrl.trim()===""},null,8,me),[[g,l.value.imageUrl]])])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"유튜브 동영상",-1)),c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value.videoUrl=a),type:"url",placeholder:"https://www.youtube.com/watch?v=...",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors",disabled:i.value&&l.value.videoUrl.trim()===""},null,8,ce),[[g,l.value.videoUrl]]),t[26]||(t[26]=e("p",{class:"text-xs text-slate-500 mt-1"}," 유튜브 동영상 URL을 입력하세요 ",-1)),y.value?(d(),n("div",pe,[e("div",xe,[e("iframe",{src:y.value,class:"w-full h-full",allowfullscreen:""},null,8,be)])])):C("",!0),e("div",fe,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"유튜브 쇼츠",-1)),c(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>l.value.shortsUrl=a),type:"url",placeholder:"https://www.youtube.com/shorts/...",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors",disabled:i.value&&l.value.shortsUrl.trim()===""},null,8,ge),[[g,l.value.shortsUrl]]),t[24]||(t[24]=e("p",{class:"text-xs text-slate-500 mt-1"}," 유튜브 쇼츠 URL을 입력하세요 ",-1)),U.value?(d(),n("div",he,[e("div",we,[e("iframe",{src:U.value,class:"w-full h-full",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,ye)])])):C("",!0)])])])]),e("div",Ue,[e("div",ke,[t[29]||(t[29]=e("div",{class:"text-sm text-slate-600"},[e("p",null,"• 작성된 게시물은 검토 후 게시됩니다"),e("p",null,"• 부적절한 내용은 삭제될 수 있습니다")],-1)),e("div",_e,[e("button",{type:"submit",disabled:!h.value||v.value,class:V(["px-8 py-3 rounded-lg font-medium transition-all duration-200",h.value&&!v.value?"bg-slate-800 hover:bg-slate-700 text-white shadow-md hover:shadow-lg":"bg-slate-300 text-slate-500 cursor-not-allowed"])},[v.value?(d(),n("span",Ve,t[28]||(t[28]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),u(" 게시 중... ")]))):(d(),n("span",Ce,"게시하기"))],10,Me)])])])],32)])])}}},Be=z(Le,[["__scopeId","data-v-ee748db1"]]);export{Be as default};
