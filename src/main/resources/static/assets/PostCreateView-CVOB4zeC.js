import{_ as V,B as L,C as S,r as v,a as f,D as B,b as r,d as t,l as D,y as P,z as j,A as z,q as a,s as u,E as N,e as A,m as R,v as p,t as h,g as q,p as F,u as H,o as n,i as G}from"./index-BZ8Nquzk.js";const J={class:"min-h-screen bg-gradient-to-br from-slate-50 to-gray-100"},$={class:"bg-white border-b border-slate-200"},E={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},O={class:"flex items-center justify-between"},T={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},K={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},W=["value"],X={class:"mt-6"},Y={class:"flex justify-between mt-1"},Z={class:"text-xs text-slate-500"},tt={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},et={class:"flex justify-between mt-1"},st={class:"text-xs text-slate-500"},ot={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},lt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},at={class:"mb-4"},rt={class:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:border-slate-400 transition-colors"},nt={key:1,class:"relative"},it=["src"],dt={key:0,class:"mt-4"},ut={class:"aspect-video bg-slate-100 rounded-lg overflow-hidden"},ct=["src"],mt={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},vt={class:"flex items-center justify-between"},pt={class:"flex space-x-4"},xt=["disabled"],gt={key:0,class:"flex items-center"},ft={key:1},bt={__name:"PostCreateView",setup(wt){const y=H(),i=L(),k=S(),s=v({title:"",category:"",content:"",imageUrl:"",videoUrl:""}),b=f(()=>i.getLoggedInUser);B(()=>{console.log("PostCreate: onMounted started."),i.initializeAuth(),console.log("PostCreate: initializeAuth completed. Checking login state."),console.log("PostCreate: current isLoggedIn value:",b.value),console.log("PostCreate: current isLoggedIn value:",i.getUserId),b.value||(alert("게시물을 작성하려면 로그인이 필요합니다. 로그인 페이지로 이동합니다."),k.openLogin())});const d=v(!1),c=v(""),x=v(null),g=f(()=>s.value.title.trim().length>0&&s.value.category.trim().length>0&&s.value.content.trim().length>=50),w=f(()=>{if(!s.value.videoUrl)return"";const o=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/,e=s.value.videoUrl.match(o);return e?`https://www.youtube.com/embed/${e[1]}`:""}),U=o=>{const e=o.target.files[0];if(!e)return;if(e.size>5*1024*1024){alert("파일 크기는 5MB 이하여야 합니다.");return}const m=new FileReader;m.onload=l=>{c.value=l.target.result},m.readAsDataURL(e)},C=()=>{c.value="",s.value.imageUrl="",x.value&&(x.value.value="")},_=()=>{localStorage.setItem("postDraft",JSON.stringify(s.value)),alert("임시저장되었습니다.")},M=()=>{const o=localStorage.getItem("postDraft");if(o){const e=JSON.parse(o);confirm("임시저장된 게시물이 있습니다. 불러오시겠습니까?")&&(s.value=e)}},I=async()=>{if(g.value){d.value=!0;try{const o={authorId:i.getUserId,title:s.value.title.trim(),category:s.value.category,content:s.value.content.trim(),imageUrl:s.value.imageUrl||null,videoUrl:s.value.videoUrl||null},e=await G.post("/post/savePosts",o);console.log("게시물 데이터:",o),console.log("서버 응답:",e.data),localStorage.removeItem("postDraft"),alert("게시물이 성공적으로 등록되었습니다!"),y.push("/")}catch(o){console.error("게시물 등록 실패:",o),alert("게시물 등록에 실패했습니다. 다시 시도해주세요.")}finally{d.value=!1}}};return M(),(o,e)=>{const m=j("router-link");return n(),r("div",J,[t("div",$,[t("div",E,[t("div",O,[e[7]||(e[7]=t("div",null,[t("h1",{class:"text-2xl font-bold text-slate-800"},"새 게시물 작성"),t("p",{class:"text-sm text-slate-500 mt-1"}," 대한민국의 미래를 함께 논의해보세요 ")],-1)),D(m,{to:"/",class:"text-slate-500 hover:text-slate-700 transition-colors"},{default:P(()=>e[6]||(e[6]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),_:1,__:[6]})])])]),t("div",T,[t("form",{onSubmit:z(I,["prevent"]),class:"space-y-8"},[t("div",K,[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[t("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),a(" 기본 정보 ")],-1)),t("div",Q,[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[a(" 카테고리 "),t("span",{class:"text-red-500"},"*")],-1)),u(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.category=l),required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},e[8]||(e[8]=[A('<option value="" data-v-4465662c>카테고리를 선택하세요</option><option value="철학" data-v-4465662c>철학</option><option value="정치" data-v-4465662c>정치</option><option value="경제" data-v-4465662c>경제</option><option value="사회" data-v-4465662c>사회</option>',5)]),512),[[N,s.value.category]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"작성자",-1)),t("input",{value:R(i).getUserId,readonly:"",class:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg text-slate-600"},null,8,W),e[11]||(e[11]=t("p",{class:"text-xs text-slate-500 mt-1"}," 사용자가 수동으로 변경할 수 없습니다. ",-1))])]),t("div",X,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[a(" 제목 "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.title=l),type:"text",required:"",maxlength:"100",placeholder:"게시물 제목을 입력하세요",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},null,512),[[p,s.value.title]]),t("div",Y,[e[12]||(e[12]=t("p",{class:"text-xs text-slate-500"}," 과한 어그로성 제목은 삼가해주세요 ",-1)),t("span",Z,h(s.value.title.length)+"/100",1)])])]),t("div",tt,[e[17]||(e[17]=t("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[t("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h7"})]),a(" 내용 작성 ")],-1)),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[a(" 본문 "),t("span",{class:"text-red-500"},"*")],-1)),u(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.content=l),required:"",rows:"12",placeholder:"게시물 내용을 작성하세요.",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors resize-none"},null,512),[[p,s.value.content]]),t("div",et,[e[15]||(e[15]=t("p",{class:"text-xs text-slate-500"}," 자유롭게 게시물을 작성해주세요. ",-1)),t("span",st,h(s.value.content.length)+"자",1)])])]),t("div",ot,[e[24]||(e[24]=t("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[t("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.587a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})]),a(" 미디어 첨부 (선택사항) ")],-1)),t("div",lt,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"이미지",-1)),t("div",at,[t("div",rt,[t("input",{ref_key:"fileInput",ref:x,type:"file",accept:"image/*",onChange:U,class:"hidden"},null,544),c.value?(n(),r("div",nt,[t("img",{src:c.value,alt:"미리보기",class:"max-h-32 mx-auto rounded"},null,8,it),t("button",{onClick:C,type:"button",class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 transform translate-x-2 -translate-y-2"},e[19]||(e[19]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])):(n(),r("div",{key:0,onClick:e[3]||(e[3]=l=>o.$refs.fileInput.click()),class:"cursor-pointer"},e[18]||(e[18]=[t("svg",{class:"mx-auto h-12 w-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),t("p",{class:"mt-2 text-sm text-slate-600"}," 클릭하여 이미지 업로드 ",-1),t("p",{class:"text-xs text-slate-500"}," PNG, JPG, GIF (최대 5MB) ",-1)])))])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-xs text-slate-500 mb-1"},"또는 이미지 URL 입력",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.imageUrl=l),type:"url",placeholder:"https://example.com/image.jpg",class:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},null,512),[[p,s.value.imageUrl]])])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"유튜브 동영상",-1)),u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.videoUrl=l),type:"url",placeholder:"https://www.youtube.com/watch?v=...",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},null,512),[[p,s.value.videoUrl]]),e[23]||(e[23]=t("p",{class:"text-xs text-slate-500 mt-1"}," 유튜브 동영상 URL을 입력하세요 ",-1)),w.value?(n(),r("div",dt,[t("div",ut,[t("iframe",{src:w.value,class:"w-full h-full",allowfullscreen:""},null,8,ct)])])):q("",!0)])])]),t("div",mt,[t("div",vt,[e[26]||(e[26]=t("div",{class:"text-sm text-slate-600"},[t("p",null,"• 작성된 게시물은 검토 후 게시됩니다"),t("p",null,"• 부적절한 내용은 삭제될 수 있습니다")],-1)),t("div",pt,[t("button",{type:"button",onClick:_,class:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors font-medium"}," 임시저장 "),t("button",{type:"submit",disabled:!g.value||d.value,class:F(["px-8 py-3 rounded-lg font-medium transition-all duration-200",g.value&&!d.value?"bg-slate-800 hover:bg-slate-700 text-white shadow-md hover:shadow-lg":"bg-slate-300 text-slate-500 cursor-not-allowed"])},[d.value?(n(),r("span",gt,e[25]||(e[25]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),a(" 게시 중... ")]))):(n(),r("span",ft,"게시하기"))],10,xt)])])])],32)])])}}},yt=V(bt,[["__scopeId","data-v-4465662c"]]);export{yt as default};
