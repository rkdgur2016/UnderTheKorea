import{_ as M,r as d,b as S,i as V,a as w,d as a,e,m as B,z as j,A as D,B as I,s as r,v as u,C as N,f as L,x as p,t as h,j as z,q as P,o as n}from"./index-Cce2zJMP.js";const R={class:"min-h-screen bg-gradient-to-br from-slate-50 to-gray-100"},F={class:"bg-white border-b border-slate-200"},q={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},A={class:"flex items-center justify-between"},H={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},J={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},G=["value"],$={class:"mt-6"},T={class:"flex justify-between mt-1"},E={class:"text-xs text-slate-500"},K={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},Q={class:"flex justify-between mt-1"},W={class:"text-xs text-slate-500"},X={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Z={class:"mb-4"},ee={class:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:border-slate-400 transition-colors"},te={key:1,class:"relative"},se=["src"],le={key:0,class:"mt-4"},oe={class:"aspect-video bg-slate-100 rounded-lg overflow-hidden"},re=["src"],ae={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},ne={class:"flex items-center justify-between"},ie={class:"flex space-x-4"},de=["disabled"],ue={key:0,class:"flex items-center"},ce={key:1},me={__name:"PostCreateView",setup(ve){const f=V(),s=d({title:"",category:"",content:"",imageUrl:"",videoUrl:""}),c=d({id:null,name:"알 수 없는 사용자"});S(()=>{const l=sessionStorage.getItem("currentUser");if(l)try{c.value=JSON.parse(l)}catch(t){console.error("Failed to parse currentUser from sessionStorage:",t),c.value={id:null,name:"게스트"},alert("사용자 정보가 올바르지 않습니다. 다시 로그인해주세요."),f.push("/login");return}else console.log("No user found in sessionStorage.")});const i=d(!1),m=d(""),x=d(null),b=w(()=>s.value.title.trim().length>0&&s.value.category.trim().length>0&&s.value.content.trim().length>=50),g=w(()=>{if(!s.value.videoUrl)return"";const l=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/,t=s.value.videoUrl.match(l);return t?`https://www.youtube.com/embed/${t[1]}`:""}),y=l=>{const t=l.target.files[0];if(!t)return;if(t.size>5*1024*1024){alert("파일 크기는 5MB 이하여야 합니다.");return}const v=new FileReader;v.onload=o=>{m.value=o.target.result},v.readAsDataURL(t)},k=()=>{m.value="",s.value.imageUrl="",x.value&&(x.value.value="")},_=()=>{localStorage.setItem("postDraft",JSON.stringify(s.value)),alert("임시저장되었습니다.")},U=()=>{const l=localStorage.getItem("postDraft");if(l){const t=JSON.parse(l);confirm("임시저장된 게시물이 있습니다. 불러오시겠습니까?")&&(s.value=t)}},C=async()=>{if(b.value){i.value=!0;try{const l={author_id:c.value.id,title:s.value.title.trim(),category:s.value.category,content:s.value.content.trim(),image_url:s.value.imageUrl||null,video_url:s.value.videoUrl||null,created_at:new Date().toISOString()};console.log("게시물 데이터:",l),localStorage.removeItem("postDraft"),alert("게시물이 성공적으로 등록되었습니다!"),f.push("/")}catch(l){console.error("게시물 등록 실패:",l),alert("게시물 등록에 실패했습니다. 다시 시도해주세요.")}finally{i.value=!1}}};return U(),(l,t)=>{const v=D("router-link");return n(),a("div",R,[e("div",F,[e("div",q,[e("div",A,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-800"},"새 게시물 작성"),e("p",{class:"text-sm text-slate-500 mt-1"},"대한민국의 미래를 함께 논의해보세요")],-1)),B(v,{to:"/",class:"text-slate-500 hover:text-slate-700 transition-colors"},{default:j(()=>t[6]||(t[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),_:1,__:[6]})])])]),e("div",H,[e("form",{onSubmit:I(C,["prevent"]),class:"space-y-8"},[e("div",J,[t[14]||(t[14]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),r(" 기본 정보 ")],-1)),e("div",O,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[r(" 카테고리 "),e("span",{class:"text-red-500"},"*")],-1)),u(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.category=o),required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},t[8]||(t[8]=[L('<option value="" data-v-bbe8416c>카테고리를 선택하세요</option><option value="철학" data-v-bbe8416c>철학</option><option value="정치" data-v-bbe8416c>정치</option><option value="경제" data-v-bbe8416c>경제</option><option value="사회" data-v-bbe8416c>사회</option>',5)]),512),[[N,s.value.category]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"작성자",-1)),e("input",{value:c.value.name||"익명 사용자",readonly:"",class:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg text-slate-600"},null,8,G),t[11]||(t[11]=e("p",{class:"text-xs text-slate-500 mt-1"},"사용자가 수동으로 변경할 수 없습니다.",-1))])]),e("div",$,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[r(" 제목 "),e("span",{class:"text-red-500"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.title=o),type:"text",required:"",maxlength:"100",placeholder:"게시물 제목을 입력하세요",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},null,512),[[p,s.value.title]]),e("div",T,[t[12]||(t[12]=e("p",{class:"text-xs text-slate-500"},"과한 어그로성 제목은 삼가해주세요",-1)),e("span",E,h(s.value.title.length)+"/100",1)])])]),e("div",K,[t[17]||(t[17]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h7"})]),r(" 내용 작성 ")],-1)),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[r(" 본문 "),e("span",{class:"text-red-500"},"*")],-1)),u(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.content=o),required:"",rows:"12",placeholder:"게시물 내용을 작성하세요.",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors resize-none"},null,512),[[p,s.value.content]]),e("div",Q,[t[15]||(t[15]=e("p",{class:"text-xs text-slate-500"},"자유롭게 게시물을 작성해주세요.",-1)),e("span",W,h(s.value.content.length)+"자",1)])])]),e("div",X,[t[24]||(t[24]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.587a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})]),r(" 미디어 첨부 (선택사항) ")],-1)),e("div",Y,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"이미지",-1)),e("div",Z,[e("div",ee,[e("input",{ref_key:"fileInput",ref:x,type:"file",accept:"image/*",onChange:y,class:"hidden"},null,544),m.value?(n(),a("div",te,[e("img",{src:m.value,alt:"미리보기",class:"max-h-32 mx-auto rounded"},null,8,se),e("button",{onClick:k,type:"button",class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 transform translate-x-2 -translate-y-2"},t[19]||(t[19]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])):(n(),a("div",{key:0,onClick:t[3]||(t[3]=o=>l.$refs.fileInput.click()),class:"cursor-pointer"},t[18]||(t[18]=[e("svg",{class:"mx-auto h-12 w-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),e("p",{class:"mt-2 text-sm text-slate-600"},"클릭하여 이미지 업로드",-1),e("p",{class:"text-xs text-slate-500"},"PNG, JPG, GIF (최대 5MB)",-1)])))])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-xs text-slate-500 mb-1"},"또는 이미지 URL 입력",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.imageUrl=o),type:"url",placeholder:"https://example.com/image.jpg",class:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},null,512),[[p,s.value.imageUrl]])])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"유튜브 동영상",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>s.value.videoUrl=o),type:"url",placeholder:"https://www.youtube.com/watch?v=...",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},null,512),[[p,s.value.videoUrl]]),t[23]||(t[23]=e("p",{class:"text-xs text-slate-500 mt-1"},"유튜브 동영상 URL을 입력하세요",-1)),g.value?(n(),a("div",le,[e("div",oe,[e("iframe",{src:g.value,class:"w-full h-full",allowfullscreen:""},null,8,re)])])):z("",!0)])])]),e("div",ae,[e("div",ne,[t[26]||(t[26]=e("div",{class:"text-sm text-slate-600"},[e("p",null,"• 작성된 게시물은 검토 후 게시됩니다"),e("p",null,"• 부적절한 내용은 삭제될 수 있습니다")],-1)),e("div",ie,[e("button",{type:"button",onClick:_,class:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors font-medium"}," 임시저장 "),e("button",{type:"submit",disabled:!b.value||i.value,class:P(["px-8 py-3 rounded-lg font-medium transition-all duration-200",b.value&&!i.value?"bg-slate-800 hover:bg-slate-700 text-white shadow-md hover:shadow-lg":"bg-slate-300 text-slate-500 cursor-not-allowed"])},[i.value?(n(),a("span",ue,t[25]||(t[25]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),r(" 게시 중... ")]))):(n(),a("span",ce,"게시하기"))],10,de)])])])],32)])])}}},xe=M(me,[["__scopeId","data-v-bbe8416c"]]);export{xe as default};
