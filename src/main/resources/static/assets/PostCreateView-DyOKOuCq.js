import{_ as j,D,E as z,r as g,a as p,b as A,w as b,e as n,f as e,p as N,A as R,B as F,C as q,v as d,x as v,G,g as H,q as $,y as x,t as k,s as _,h as C,u as J,o as u,j as E}from"./index-C8I4DoQr.js";const O={class:"min-h-screen bg-gradient-to-br from-slate-50 to-gray-100"},T={class:"bg-white border-b border-slate-200"},Z={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},K={class:"flex items-center justify-between"},Q={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},W={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Y=["value"],ee={class:"mt-6"},te={class:"flex justify-between mt-1"},le={class:"text-xs text-slate-500"},se={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},oe={class:"flex justify-between mt-1"},ae={class:"text-xs text-slate-500"},re={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},ie={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ne={class:"mb-4"},de={class:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:border-slate-400 transition-colors"},ue=["disabled"],ve={key:1,class:"relative"},ce=["src"],me=["disabled"],pe=["disabled"],xe={key:0,class:"mt-4"},fe={class:"aspect-video bg-slate-100 rounded-lg overflow-hidden"},ge=["src"],be={class:"mt-6"},he=["disabled"],we={key:0,class:"mt-4"},ye={class:"aspect-video bg-slate-100 rounded-lg overflow-hidden"},Ue=["src"],ke={class:"bg-white rounded-xl shadow-sm border border-slate-200 p-6"},_e={class:"flex items-center justify-between"},Ce={class:"flex space-x-4"},Me=["disabled"],Ie={key:0,class:"flex items-center"},Ve={key:1},Le={__name:"PostCreateView",setup(Se){const M=J(),c=D(),I=z(),l=g({title:"",category:"",content:"",imageUrl:"",videoUrl:"",shortsUrl:""}),w=p(()=>c.getLoggedInUser);A(()=>{console.log("PostCreate: onMounted started."),c.initializeAuth(),console.log("PostCreate: initializeAuth completed. Checking login state."),console.log("PostCreate: current isLoggedIn value:",w.value),console.log("PostCreate: current isLoggedIn value:",c.getUserId),w.value||(alert("게시물을 작성하려면 로그인이 필요합니다. 로그인 페이지로 이동합니다."),I.openLogin())});const m=g(!1),o=g(""),r=g(null),h=p(()=>l.value.title.trim().length>0&&l.value.category.trim().length>0&&l.value.content.trim().length>=50),y=p(()=>{if(!l.value.videoUrl)return"";const s=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/,t=l.value.videoUrl.match(s);return t?`https://www.youtube.com/embed/${t[1]}`:""}),U=p(()=>{if(!l.value.shortsUrl)return"";const s=/(?:youtube\.com\/shorts\/|youtu\.be\/)([a-zA-Z0-9_-]+)/,t=l.value.shortsUrl.match(s);return t?`https://www.youtube.com/embed/${t[1]}`:""}),V=s=>{const t=s.target.files[0];if(!t)return;if(t.size>5*1024*1024){alert("파일 크기는 5MB 이하여야 합니다."),r.value&&(r.value.value=""),o.value="";return}const f=new FileReader;f.onload=a=>{o.value=a.target.result},f.readAsDataURL(t),l.value.imageUrl=""},L=()=>{o.value="",l.value.imageUrl="",r.value&&(r.value.value="")},S=()=>{localStorage.setItem("postDraft",JSON.stringify(l.value)),alert("임시저장되었습니다.")},P=()=>{const s=localStorage.getItem("postDraft");if(s){const t=JSON.parse(s);confirm("임시저장된 게시물이 있습니다. 불러오시겠습니까?")&&(l.value=t)}},i=p(()=>o.value!==""||l.value.imageUrl.trim()!==""||l.value.videoUrl.trim()!==""||l.value.shortsUrl.trim()!==""),B=async()=>{if(h.value){m.value=!0;try{const s={authorId:c.getUserId,title:l.value.title.trim(),category:l.value.category,content:l.value.content.trim(),imageUrl:l.value.imageUrl||null,videoUrl:l.value.videoUrl||null,shortUrl:l.value.shortsUrl||null},t=await E.post("/post/savePosts",s);console.log("게시물 데이터:",s),console.log("서버 응답:",t.data),localStorage.removeItem("postDraft"),alert("게시물이 성공적으로 등록되었습니다!"),M.push("/")}catch(s){console.error("게시물 등록 실패:",s),alert("게시물 등록에 실패했습니다. 다시 시도해주세요.")}finally{m.value=!1}}};return P(),b(()=>l.value.imageUrl,(s,t)=>{s&&s.trim()!==""&&(l.value.videoUrl="",l.value.shortsUrl="",o.value="",r.value&&(r.value.value=""))}),b(()=>l.value.videoUrl,(s,t)=>{s&&s.trim()!==""&&(l.value.imageUrl="",l.value.shortsUrl="",o.value="",r.value&&(r.value.value=""))}),b(()=>l.value.shortsUrl,(s,t)=>{s&&s.trim()!==""&&(l.value.imageUrl="",l.value.videoUrl="",o.value="",r.value&&(r.value.value=""))}),b(o,(s,t)=>{s!==""&&(l.value.imageUrl="",l.value.videoUrl="",l.value.shortsUrl="")}),(s,t)=>{const f=F("router-link");return u(),n("div",O,[e("div",T,[e("div",Z,[e("div",K,[t[8]||(t[8]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-800"},"새 게시물 작성"),e("p",{class:"text-sm text-slate-500 mt-1"}," 대한민국의 미래를 함께 논의해보세요 ")],-1)),N(f,{to:"/",class:"text-slate-500 hover:text-slate-700 transition-colors"},{default:R(()=>t[7]||(t[7]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),_:1,__:[7]})])])]),e("div",Q,[e("form",{onSubmit:q(B,["prevent"]),class:"space-y-8"},[e("div",W,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),d(" 기본 정보 ")],-1)),e("div",X,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[d(" 카테고리 "),e("span",{class:"text-red-500"},"*")],-1)),v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>l.value.category=a),required:"",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},t[9]||(t[9]=[H('<option value="" data-v-472e4c1f>카테고리를 선택하세요</option><option value="철학" data-v-472e4c1f>철학</option><option value="정치" data-v-472e4c1f>정치</option><option value="경제" data-v-472e4c1f>경제</option><option value="사회" data-v-472e4c1f>사회</option>',5)]),512),[[G,l.value.category]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"작성자",-1)),e("input",{value:$(c).getUserId,readonly:"",class:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg text-slate-600"},null,8,Y),t[12]||(t[12]=e("p",{class:"text-xs text-slate-500 mt-1"}," 사용자가 수동으로 변경할 수 없습니다. ",-1))])]),e("div",ee,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[d(" 제목 "),e("span",{class:"text-red-500"},"*")],-1)),v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.title=a),type:"text",required:"",maxlength:"100",placeholder:"게시물 제목을 입력하세요",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors"},null,512),[[x,l.value.title]]),e("div",te,[t[13]||(t[13]=e("p",{class:"text-xs text-slate-500"}," 과한 어그로성 제목은 삼가해주세요 ",-1)),e("span",le,k(l.value.title.length)+"/100",1)])])]),e("div",se,[t[18]||(t[18]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h7"})]),d(" 내용 작성 ")],-1)),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},[d(" 본문 "),e("span",{class:"text-red-500"},"*")],-1)),v(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=a=>l.value.content=a),required:"",rows:"12",placeholder:"게시물 내용을 작성하세요.",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors resize-none"},null,512),[[x,l.value.content]]),e("div",oe,[t[16]||(t[16]=e("p",{class:"text-xs text-slate-500"}," 자유롭게 게시물을 작성해주세요. ",-1)),e("span",ae,k(l.value.content.length)+"자",1)])])]),e("div",re,[t[27]||(t[27]=e("h2",{class:"text-lg font-semibold text-slate-800 mb-6 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.587a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})]),d(" 미디어 첨부 (선택사항) ")],-1)),e("div",ie,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"이미지",-1)),e("div",ne,[e("div",de,[e("input",{ref_key:"fileInput",ref:r,type:"file",accept:"image/*",onChange:V,class:"hidden",disabled:i.value&&!o.value},null,40,ue),o.value?(u(),n("div",ve,[e("img",{src:o.value,alt:"미리보기",class:"max-h-32 mx-auto rounded"},null,8,ce),e("button",{onClick:L,type:"button",class:"absolute top-0 right-0 bg-red-500 text-white rounded-full p-1 transform translate-x-2 -translate-y-2"},t[20]||(t[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])):(u(),n("div",{key:0,onClick:t[3]||(t[3]=a=>(!i.value||!o.value)&&s.$refs.fileInput.click()),class:_({"cursor-pointer":!i.value||!o.value,"cursor-not-allowed opacity-50":i.value&&!o.value})},t[19]||(t[19]=[e("svg",{class:"mx-auto h-12 w-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),e("p",{class:"mt-2 text-sm text-slate-600"}," 클릭하여 이미지 업로드 ",-1),e("p",{class:"text-xs text-slate-500"}," PNG, JPG, GIF (최대 5MB) ",-1)]),2))])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-xs text-slate-500 mb-1"},"또는 이미지 URL 입력",-1)),v(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.imageUrl=a),type:"url",placeholder:"https://example.com/image.jpg",class:"w-full px-3 py-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors",disabled:i.value&&l.value.imageUrl.trim()===""},null,8,me),[[x,l.value.imageUrl]])])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"유튜브 동영상",-1)),v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.value.videoUrl=a),type:"url",placeholder:"https://www.youtube.com/watch?v=...",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors",disabled:i.value&&l.value.videoUrl.trim()===""},null,8,pe),[[x,l.value.videoUrl]]),t[26]||(t[26]=e("p",{class:"text-xs text-slate-500 mt-1"}," 유튜브 동영상 URL을 입력하세요 ",-1)),y.value?(u(),n("div",xe,[e("div",fe,[e("iframe",{src:y.value,class:"w-full h-full",allowfullscreen:""},null,8,ge)])])):C("",!0),e("div",be,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-slate-700 mb-2"},"유튜브 쇼츠",-1)),v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>l.value.shortsUrl=a),type:"url",placeholder:"https://www.youtube.com/shorts/...",class:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-500 focus:border-slate-500 transition-colors",disabled:i.value&&l.value.shortsUrl.trim()===""},null,8,he),[[x,l.value.shortsUrl]]),t[24]||(t[24]=e("p",{class:"text-xs text-slate-500 mt-1"}," 유튜브 쇼츠 URL을 입력하세요 ",-1)),U.value?(u(),n("div",we,[e("div",ye,[e("iframe",{src:U.value,class:"w-full h-full",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,Ue)])])):C("",!0)])])])]),e("div",ke,[e("div",_e,[t[29]||(t[29]=e("div",{class:"text-sm text-slate-600"},[e("p",null,"• 작성된 게시물은 검토 후 게시됩니다"),e("p",null,"• 부적절한 내용은 삭제될 수 있습니다")],-1)),e("div",Ce,[e("button",{type:"button",onClick:S,class:"px-6 py-3 border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition-colors font-medium"}," 임시저장 "),e("button",{type:"submit",disabled:!h.value||m.value,class:_(["px-8 py-3 rounded-lg font-medium transition-all duration-200",h.value&&!m.value?"bg-slate-800 hover:bg-slate-700 text-white shadow-md hover:shadow-lg":"bg-slate-300 text-slate-500 cursor-not-allowed"])},[m.value?(u(),n("span",Ie,t[28]||(t[28]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),d(" 게시 중... ")]))):(u(),n("span",Ve,"게시하기"))],10,Me)])])])],32)])])}}},Be=j(Le,[["__scopeId","data-v-472e4c1f"]]);export{Be as default};
